function S = noisyflat_channel_diagnostics(S,EEG)

% (inverse) variance over data points/trials per channels
varv = std(reshape(EEG.data,size(EEG.data),[]),[],2);
invvar = 1./varv;

% (inverse) variance over channels
varv_chan = std(varv);
invvar_chan = 1./varv_chan;

% outputs
S.prep.chandiag.noisychan.chans_reject_labels_ordered = chans(si(1:length(S.prep.clean.noisychan.rejchan)));
S.prep.chandiag.noisychan.rejtrial = [];
S.prep.chanduag.noisychan.median_frac_trials = median(trialfrac);
